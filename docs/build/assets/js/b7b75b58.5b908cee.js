"use strict";(self.webpackChunkmare_ai=self.webpackChunkmare_ai||[]).push([[7181],{28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>l});var a=t(96540);const i={},s=a.createContext(i);function r(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(s.Provider,{value:n},e.children)}},42006:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"extract/validators/validators","title":"validators","description":"Validators","source":"@site/docs/extract/validators/validators.md","sourceDirName":"extract/validators","slug":"/extract/validators/","permalink":"/docs/extract/validators/","draft":false,"unlisted":false,"editUrl":"https://github.com/marieai/marie-ai/tree/main/docs/docs/extract/validators/validators.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"validators-add","permalink":"/docs/extract/validators/validators-add"},"next":{"title":"Component Registry","permalink":"/docs/extract/component-registry"}}');var i=t(74848),s=t(28453);const r={},l=void 0,o={},d=[{value:"Validators",id:"validators",level:2},{value:"What a validator does",id:"what-a-validator-does",level:3},{value:"When validators run",id:"when-validators-run",level:3},{value:"How validators are referenced",id:"how-validators-are-referenced",level:3},{value:"Adding validators to an annotator config",id:"adding-validators-to-an-annotator-config",level:3},{value:"Authoring a new validator",id:"authoring-a-new-validator",level:3},{value:"Best practices",id:"best-practices",level:3},{value:"Troubleshooting",id:"troubleshooting",level:3}];function c(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"validators",children:"Validators"}),"\n",(0,i.jsx)(n.p,{children:"Validators are pluggable checks that verify inputs, intermediate artifacts, and final outputs at specific points in the annotation pipeline. They help you enforce schema conformance, file/artifact completeness, and domain constraints, and they surface actionable diagnostics early."}),"\n",(0,i.jsx)(n.h3,{id:"what-a-validator-does",children:"What a validator does"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Accepts a ValidationContext containing:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Stage: where in the pipeline the check is running (e.g., pre-processing vs parse-output)."}),"\n",(0,i.jsx)(n.li,{children:"Input data and/or file system locations relevant to the check."}),"\n",(0,i.jsx)(n.li,{children:"Arbitrary metadata you choose to pass in (e.g., agent_output_dir, folder sets)."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Returns a ValidationResult with:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"valid: boolean pass/fail status."}),"\n",(0,i.jsx)(n.li,{children:"errors and warnings: machine- and human-readable diagnostics (code, message, optional field)."}),"\n",(0,i.jsx)(n.li,{children:"metadata: structured details that help debugging or reporting."}),"\n",(0,i.jsx)(n.li,{children:"execution_time: timing info for observability."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Validators only run for stages they declare support for."}),"\n",(0,i.jsx)(n.h3,{id:"when-validators-run",children:"When validators run"}),"\n",(0,i.jsx)(n.p,{children:"Validators can be attached to different lifecycle stages, for example:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"PRE_PROCESSING: Validate that required folders or artifacts exist before heavy work runs."}),"\n",(0,i.jsx)(n.li,{children:"PARSE_OUTPUT: Validate the structure and semantics of the annotator\u2019s outputs."}),"\n",(0,i.jsx)(n.li,{children:"POST_PROCESSING: Validate final normalized results (optional)."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Only validators that declare support for a given stage will run during that stage."}),"\n",(0,i.jsx)(n.h3,{id:"how-validators-are-referenced",children:"How validators are referenced"}),"\n",(0,i.jsx)(n.p,{children:"Validators are referenced by name in your annotator configuration. Example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'annotators:\n  claims:\n    annotator_type: "llm"\n    model_config:\n      model_name: deepseek_r1_32\n      prompt_path: "./claims.j2"\n      system_prompt_text: >\n        ### Task\n        You are a helpful assistant that extracts claims from the given text.\n      expect_output: "json"\n    parser_name: default\n    validators:\n      - "claims"              # schema/structure for claims output\n      - "document_structure"  # generic structural checks\n'})}),"\n",(0,i.jsx)(n.p,{children:"Attach as many validators as you need; each runs independently and reports its own result."}),"\n",(0,i.jsx)(n.h3,{id:"adding-validators-to-an-annotator-config",children:"Adding validators to an annotator config"}),"\n",(0,i.jsx)(n.p,{children:"Attach validators to any annotator in the same way you attach parsers or model settings:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'annotators:\n  tables:\n    annotator_type: "llm"\n    model_config:\n      model_name: deepseek_r1_32\n      prompt_path: "./tables.j2"\n      expect_output: "json"\n    parser_name: default\n    validators:\n      - "tables"                 # domain/schema validator\n      - "folder_sets_audit"      # file set integrity\n      - "document_structure"     # general structure\n'})}),"\n",(0,i.jsx)(n.h3,{id:"authoring-a-new-validator",children:"Authoring a new validator"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Define its goal and stage"}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Decide which artifact or output you\u2019re validating and at which stage it makes sense to run (e.g., PRE_PROCESSING to ensure inputs exist, PARSE_OUTPUT to validate JSON shape)."}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Decide the context metadata you need"}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Common items: agent_output_dir, folder names, file extensions, expected file companions, schema hints."}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Implement the validator"}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Expose a unique name (used in config)."}),"\n",(0,i.jsx)(n.li,{children:"Declare supported stages (it can support multiple)."}),"\n",(0,i.jsx)(n.li,{children:"Read context metadata and perform checks."}),"\n",(0,i.jsxs)(n.li,{children:["Return a result with:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"valid flag."}),"\n",(0,i.jsx)(n.li,{children:"zero or more errors/warnings (each with a code and human-readable message)."}),"\n",(0,i.jsx)(n.li,{children:"optional metadata for diagnostics (counts, paths, expectations)."}),"\n",(0,i.jsx)(n.li,{children:"the system records execution time automatically for observability."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{start:"4",children:["\n",(0,i.jsx)(n.li,{children:"Register the validator"}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure it can be referenced by name in annotator configs."}),"\n"]}),"\n",(0,i.jsxs)(n.ol,{start:"5",children:["\n",(0,i.jsx)(n.li,{children:"Test"}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Provide a minimal test harness or run it in a dry-run pipeline to verify:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Correct handling of missing folders/files."}),"\n",(0,i.jsx)(n.li,{children:"Comprehensible error/warning messages."}),"\n",(0,i.jsx)(n.li,{children:"Accurate counts in metadata."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"best-practices",children:"Best practices"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Be explicit and stable:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use consistent error codes (e.g., MISSING_ANNOTATIONS, FOLDER_MISSING, MISMATCHED_FILE_COUNTS)."}),"\n",(0,i.jsx)(n.li,{children:"Keep messages actionable (\u201cmissing 2 of 10 companions\u201d)."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Keep checks cheap:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Validators often run before heavier stages\u2014fail fast on missing inputs."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Make diagnostics useful:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Include counts, file paths, and per-folder summaries in metadata to speed up debugging."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Compose validators:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Prefer small, focused validators that can be combined in different annotators rather than large, one-off checks."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u201cValidator does not support stage \u2026\u201d:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure the validator is configured for the stage it runs in. Add the desired stage to its supported set."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u201cFile/folder missing\u201d but it exists:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Verify that agent_output_dir and other path inputs are pointing to the correct job/workspace. Check permissions and casing."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u201cMismatched file counts\u201d:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Ensure your pipeline produces a consistent trio of files (.json, .png, and prompt sidecars) or the required companions for markdown/fragment workflows."}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Silent passes with unexpected outputs:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Add a stricter, domain-specific validator (e.g., claims, tables) to enforce schema and field requirements, not just file presence."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"With validators in place, you can catch issues early, enforce invariants across annotators, and keep your extraction pipeline reliable and auditable."})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);