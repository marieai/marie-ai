"use strict";(self.webpackChunkmare_ai=self.webpackChunkmare_ai||[]).push([[6250],{28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>s});var t=i(96540);const a={},o=t.createContext(a);function r(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(o.Provider,{value:n},e.children)}},42265:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>r,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"guides/pipelines","title":"Document Pipelines","description":"Document pipelines are the core of the document processing system. They are responsible for processing documents and","source":"@site/docs/guides/pipelines.md","sourceDirName":"guides","slug":"/guides/pipelines","permalink":"/docs/guides/pipelines","draft":false,"unlisted":false,"editUrl":"https://github.com/marieai/marie-ai/tree/main/docs/docs/guides/pipelines.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Flow","permalink":"/docs/guides/flow"},"next":{"title":"Template Matching","permalink":"/docs/guides/template_matching"}}');var a=i(74848),o=i(28453);const r={sidebar_position:1},s="Document Pipelines",c={},l=[{value:"Basic Concepts",id:"basic-concepts",level:2},{value:"Pipeline Components",id:"pipeline-components",level:2},{value:"Pipeline Configuration",id:"pipeline-configuration",level:2},{value:"Runtime Configuration",id:"runtime-configuration",level:2}];function p(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"document-pipelines",children:"Document Pipelines"})}),"\n",(0,a.jsx)(n.p,{children:"Document pipelines are the core of the document processing system. They are responsible for processing documents and\nextracting information from them."}),"\n",(0,a.jsx)(n.h2,{id:"basic-concepts",children:"Basic Concepts"}),"\n",(0,a.jsx)(n.h2,{id:"pipeline-components",children:"Pipeline Components"}),"\n",(0,a.jsx)(n.h2,{id:"pipeline-configuration",children:"Pipeline Configuration"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"executors:\n  - name: extract_t\n    uses:\n      jtype: TextExtractionExecutor\n      with:\n        storage:\n          # postgresql configuration. Will be used only if value of backend is \"psql\"\n          psql:\n            <<: *psql_conf_shared\n            default_table: extract_metadata\n            enabled: True\n        pipeline:\n          name: 'default'\n          page_classifier:\n            - model_name_or_path: 'marie/lmv3-medical-document-classification'\n              type: 'transformers'\n              device: 'cuda'\n              enabled: True\n              name: 'medical_page_classifier'\n            - model_name_or_path: 'marie/lmv3-medical-document-payer'\n              type: 'transformers'\n              enabled: True\n              device: 'cuda'\n              name: 'medical_payer_classifier'\n          page_indexer:\n            - model_name_or_path: 'marie/layoutlmv3-medical-document-indexer'\n              enabled: True\n              type: 'transformers'\n              device: 'cuda'\n              name: 'page_indexer_patient'\n              filter:\n                type: 'regex'\n                pattern: '.*'\n          page_splitter:\n            model_name_or_path: 'marie/layoutlmv3-medical-document-splitter'\n            enabled: True\n      metas:\n        py_modules:\n          - marie.executor.text\n    timeout_ready: 3000000\n    replicas: 1\n    #    replicas: ${{ CONTEXT.gpu_device_count }}\n    env:\n      CUDA_VISIBLE_DEVICES: RR\n\n"})}),"\n",(0,a.jsx)(n.h2,{id:"runtime-configuration",children:"Runtime Configuration"}),"\n",(0,a.jsx)(n.p,{children:"Each pipeline can be configured at runtime. This allows for the configuration of the pipeline to be changed without\nrestarting the application and without affecting other pipelines."}),"\n",(0,a.jsxs)(n.p,{children:["Sample payload configuration to be sent to the pipeline with the ",(0,a.jsx)(n.code,{children:"POST /api/extract"})," endpoint:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "queue_id": "0000-0000-0000-0000",\n  "data": "s3|base64||url",\n  "mode": "MULTILINE|RAW|SPARSE|LINE",\n  "doc_id": "1234",\n  "doc_type": "extract-adhoc",\n  "features": [\n    {\n      "type": "pipeline",\n      "name": "default",\n      "page_classifier": {\n        "enabled": true\n      },\n      "page_splitter": {\n        "enabled": true\n      },\n      "overlay": {\n        "enabled": false\n      },\n      "ocr": {\n        "document": {\n          "engine": "default"\n        },\n        "region": {\n          "engine": "best"\n        }\n      }\n    }\n  ]\n}\n\n'})})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}}}]);