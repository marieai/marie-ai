"use strict";(self.webpackChunkmare_ai=self.webpackChunkmare_ai||[]).push([[1044],{28453:(e,s,n)=>{n.d(s,{R:()=>c,x:()=>l});var i=n(96540);const t={},r=i.createContext(t);function c(e){const s=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:c(e.components),i.createElement(r.Provider,{value:s},e.children)}},77884:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>l,default:()=>p,frontMatter:()=>c,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"getting-started/inference/undervolt","title":"Undervolt NVIDIA GPUs","description":"List all NVIDIA GPUs:","source":"@site/docs/getting-started/inference/undervolt.md","sourceDirName":"getting-started/inference","slug":"/getting-started/inference/undervolt","permalink":"/docs/getting-started/inference/undervolt","draft":false,"unlisted":false,"editUrl":"https://github.com/marieai/marie-ai/tree/main/docs/docs/getting-started/inference/undervolt.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Optimizing models for inference with ONNX","permalink":"/docs/getting-started/inference/onnx"},"next":{"title":"Job Management","permalink":"/docs/category/job-management"}}');var t=n(74848),r=n(28453);const c={sidebar_position:3},l="Undervolt NVIDIA GPUs",a={},d=[{value:"Stress test GPU",id:"stress-test-gpu",level:2},{value:"Enable persistence mode",id:"enable-persistence-mode",level:2},{value:"Adjust GPU power limit",id:"adjust-gpu-power-limit",level:2},{value:"Adjust GPU clock speed",id:"adjust-gpu-clock-speed",level:2},{value:"References",id:"references",level:2}];function o(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"undervolt-nvidia-gpus",children:"Undervolt NVIDIA GPUs"})}),"\n",(0,t.jsx)(s.p,{children:"List all NVIDIA GPUs:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"nvidia-smi -L\n"})}),"\n",(0,t.jsx)(s.p,{children:"List all available clocks:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"nvidia-smi -q -d SUPPORTED_CLOCKS\n"})}),"\n",(0,t.jsx)(s.p,{children:"To review the current GPU clock speed, default clock speed, and maximum possible clock speed, run:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"nvidia-smi -q -d CLOCK\n"})}),"\n",(0,t.jsx)(s.h2,{id:"stress-test-gpu",children:"Stress test GPU"}),"\n",(0,t.jsx)(s.p,{children:"Start monitoring GPU usage:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"nvidia-smi --query-gpu=index,timestamp,power.draw,clocks.sm,clocks.mem,clocks.gr --format=csv -l 1\n"})}),"\n",(0,t.jsx)(s.p,{children:"Start stress test:"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"docker run --rm --gpus all gpu_burn\n"})}),"\n",(0,t.jsx)(s.h2,{id:"enable-persistence-mode",children:"Enable persistence mode"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"sudo nvidia-smi -pm 1\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"Enabled persistence mode for GPU 00000000:03:00.0.\nEnabled persistence mode for GPU 00000000:04:00.0.\n"})}),"\n",(0,t.jsx)(s.h2,{id:"adjust-gpu-power-limit",children:"Adjust GPU power limit"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"sudo nvidia-smi -pl 350\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:"Power limit for GPU 00000000:03:00.0 was set to 200.00 W from 450.00 W.\nPower limit for GPU 00000000:04:00.0 was set to 200.00 W from 450.00 W.\n"})}),"\n",(0,t.jsx)(s.h2,{id:"adjust-gpu-clock-speed",children:"Adjust GPU clock speed"}),"\n",(0,t.jsx)(s.p,{children:"4"}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-shell",children:"nvidia-smi -i 0 -lgc 0,<base_clock>\n\nsudo nvidia-smi -lgc 0,2100\n"})}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-text",children:'GPU clocks set to "(gpuClkMin 0, gpuClkMax 1860)" for GPU 00000000:03:00.0\nGPU clocks set to "(gpuClkMin 0, gpuClkMax 1860)" for GPU 00000000:04:00.0\nGPU clocks set to "(gpuClkMin 0, gpuClkMax 1860)" for GPU 00000000:05:00.0\nGPU clocks set to "(gpuClkMin 0, gpuClkMax 1860)" for GPU 00000000:06:00.0\n\n'})}),"\n",(0,t.jsx)(s.h2,{id:"references",children:"References"}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.a,{href:"https://nvidia.custhelp.com/app/answers/detail/a_id/3751/~/useful-nvidia-smi-queries",children:"https://nvidia.custhelp.com/app/answers/detail/a_id/3751/~/useful-nvidia-smi-queries"}),"\n",(0,t.jsx)(s.a,{href:"https://www.microway.com/hpc-tech-tips/nvidia-smi_control-your-gpus/",children:"https://www.microway.com/hpc-tech-tips/nvidia-smi_control-your-gpus/"}),"\n",(0,t.jsx)(s.a,{href:"https://linustechtips.com/topic/1259546-how-to-undervolt-nvidia-gpus-in-linux/",children:"https://linustechtips.com/topic/1259546-how-to-undervolt-nvidia-gpus-in-linux/"})]}),"\n",(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.a,{href:"https://github.com/wilicc/gpu-burn",children:"https://github.com/wilicc/gpu-burn"}),"\n",(0,t.jsx)(s.a,{href:"https://github.com/waggle-sensor/gpu-stress-test",children:"https://github.com/waggle-sensor/gpu-stress-test"})]}),"\n",(0,t.jsx)(s.p,{children:"Device 0 [NVIDIA GeForce RTX 3090 Ti] PCIe GEN 3@ 8x RX: 19.53 MiB/s TX: 8.789 MiB/s Device 1 [NVIDIA GeForce RTX 3090 Ti] PCIe GEN 3@ 8x RX: 28.32 MiB/s TX: 8.789 MiB/s\nGPU 1815MHz MEM 10251MH TEMP  58\xb0C FAN  69% POW 447 / 450 W                          GPU 1740MHz MEM 10251MH TEMP  57\xb0C FAN  59% POW 446 / 450 W\nGPU[||||||||||||||||||||||||||||||||100%] MEM[||||||||||||||||||||22.158Gi/23.988Gi] GPU[||||||||||||||||||||||||||||||||100%] MEM[||||||||||||||||||||22.226Gi/23.988Gi]"}),"\n",(0,t.jsx)(s.p,{children:"Device 2 [NVIDIA GeForce RTX 3090 Ti] PCIe GEN 3@ 8x RX: 27.34 MiB/s TX: 8.789 MiB/s Device 3 [NVIDIA GeForce RTX 3090 Ti] PCIe GEN 3@ 8x RX: 22.46 MiB/s TX: 6.836 MiB/s\nGPU 1830MHz MEM 10251MH TEMP  59\xb0C FAN  71% POW 447 / 450 W                          GPU 1770MHz MEM 10251MH TEMP  58\xb0C FAN  66% POW 448 / 450 W\nGPU[||||||||||||||||||||||||||||||||100%] MEM[||||||||||||||||||||22.260Gi/23.988Gi] GPU[||||||||||||||||||||||||||||||||100%] MEM[||||||||||||||||||||21.918Gi/23.988Gi]"})]})}function p(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}}}]);