"use strict";(self.webpackChunkmare_ai=self.webpackChunkmare_ai||[]).push([[4609],{28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>o});var i=s(96540);const r={},l=i.createContext(r);function t(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(l.Provider,{value:n},e.children)}},91059:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"extract/structured-region","title":"Documentation: Structured Region System for Document Processing","description":"This document provides comprehensive training material for understanding the structured region system used in document processing, covering roles, role hints, and key data structures.","source":"@site/docs/extract/structured-region.md","sourceDirName":"extract","slug":"/extract/structured-region","permalink":"/docs/extract/structured-region","draft":false,"unlisted":false,"editUrl":"https://github.com/marieai/marie-ai/tree/main/docs/docs/extract/structured-region.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Marie Scheduler: SLA-Based Job Priority Design","permalink":"/docs/extract/sla"},"next":{"title":"Getting Started","permalink":"/docs/category/getting-started"}}');var r=s(74848),l=s(28453);const t={},o="Documentation: Structured Region System for Document Processing",a={},c=[{value:"Overview",id:"overview",level:2},{value:"Core Concepts",id:"core-concepts",level:2},{value:"Roles and Role Hints",id:"roles-and-role-hints",level:3},{value:"SectionRole (Layout Roles)",id:"sectionrole-layout-roles",level:4},{value:"Role Hints (Semantic Roles)",id:"role-hints-semantic-roles",level:4},{value:"Role Normalization Process",id:"role-normalization-process",level:4},{value:"Core Data Structures",id:"core-data-structures",level:2},{value:"1. KeyValue",id:"1-keyvalue",level:3},{value:"2. KVList",id:"2-kvlist",level:3},{value:"3. RowRole",id:"3-rowrole",level:3},{value:"4. TableRow",id:"4-tablerow",level:3},{value:"5. TableSeries",id:"5-tableseries",level:3},{value:"6. Section",id:"6-section",level:3},{value:"7. StructuredRegion",id:"7-structuredregion",level:3},{value:"8. ValueType",id:"8-valuetype",level:3},{value:"Builder Functions",id:"builder-functions",level:2},{value:"build_structured_region()",id:"build_structured_region",level:3},{value:"build_table_series_from_pagespan()",id:"build_table_series_from_pagespan",level:3},{value:"Configuration Examples",id:"configuration-examples",level:2},{value:"Layer Configuration with Roles",id:"layer-configuration-with-roles",level:3},{value:"Processing Flow",id:"processing-flow",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Role Assignment",id:"role-assignment",level:3},{value:"Section Organization",id:"section-organization",level:3},{value:"Multi-page Handling",id:"multi-page-handling",level:3},{value:"Validation",id:"validation",level:3},{value:"How Role Hints Are Used in Production",id:"how-role-hints-are-used-in-production",level:2},{value:"Role Hint Processing Flow",id:"role-hint-processing-flow",level:2},{value:"1. <strong>Section Processing Discovery</strong>",id:"1-section-processing-discovery",level:3},{value:"2. <strong>Processing Method Selection</strong>",id:"2-processing-method-selection",level:3},{value:"3. <strong>Field Mapping Based on Role Hints</strong>",id:"3-field-mapping-based-on-role-hints",level:3},{value:"Practical Usage Examples",id:"practical-usage-examples",level:2},{value:"Example 1: Service Lines Processing",id:"example-1-service-lines-processing",level:3},{value:"Example 2: Remarks Processing",id:"example-2-remarks-processing",level:3},{value:"Example 3: Claim Information Processing",id:"example-3-claim-information-processing",level:3},{value:"Advanced Role Hint Usage",id:"advanced-role-hint-usage",level:2},{value:"1. <strong>Conditional Processing Rules</strong>",id:"1-conditional-processing-rules",level:3},{value:"2. <strong>Role Hint Inheritance</strong>",id:"2-role-hint-inheritance",level:3},{value:"3. <strong>Multi-Role Processing</strong>",id:"3-multi-role-processing",level:3},{value:"Configuration Patterns",id:"configuration-patterns",level:2},{value:"Pattern 1: Role-Specific Field Scoping",id:"pattern-1-role-specific-field-scoping",level:3},{value:"Pattern 2: Processing Method Override",id:"pattern-2-processing-method-override",level:3},{value:"Pattern 3: Cross-Section Dependencies",id:"pattern-3-cross-section-dependencies",level:3},{value:"Best Practices for Role Hint Usage",id:"best-practices-for-role-hint-usage",level:2},{value:"1. <strong>Consistent Naming</strong>",id:"1-consistent-naming",level:3},{value:"2. <strong>Hierarchical Organization</strong>",id:"2-hierarchical-organization",level:3},{value:"3. <strong>Role Hint Documentation</strong>",id:"3-role-hint-documentation",level:3},{value:"4. <strong>Validation and Error Handling</strong>",id:"4-validation-and-error-handling",level:3},{value:"Summary",id:"summary",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"documentation-structured-region-system-for-document-processing",children:"Documentation: Structured Region System for Document Processing"})}),"\n",(0,r.jsx)(n.p,{children:"This document provides comprehensive training material for understanding the structured region system used in document processing, covering roles, role hints, and key data structures."}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"The structured region system is designed to parse and organize document content into hierarchical, semantic structures. It transforms raw document annotations into structured data that can be processed by downstream systems for field extraction, table processing, and content analysis."}),"\n",(0,r.jsx)(n.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,r.jsx)(n.h3,{id:"roles-and-role-hints",children:"Roles and Role Hints"}),"\n",(0,r.jsx)(n.p,{children:"Role hints provide the critical bridge between static configuration and dynamic processing logic. They enable:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Selective Processing"}),": Only relevant sections get processed by appropriate handlers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Field Scoping"}),": Different annotation selectors apply to different section types"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Business Logic"}),": Custom processing rules based on document semantics"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Extensibility"}),": Easy addition of new section types without code changes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Maintainability"}),": Clear separation between layout roles and business logic"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"sectionrole-layout-roles",children:"SectionRole (Layout Roles)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"SectionRole"})," is an enum that defines the ",(0,r.jsx)(n.strong,{children:"layout-level positioning"})," and ",(0,r.jsx)(n.strong,{children:"processing priority"})," of sections within a document:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'class SectionRole(str, Enum):\n    CONTEXT_ABOVE = "context_above"    # Header-like context (e.g., claim info)\n    MAIN = "main"                      # Primary content (e.g., service lines table)\n    CONTEXT_BELOW = "context_below"    # Footer-like context (e.g., totals)\n    SIDEBAR = "sidebar"                # Auxiliary content\n    UNKNOWN = "unknown"                # Fallback for unclassified content\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Purpose:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Layout Control"}),": Determines where sections appear in the final document structure"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Processing Priority"}),": ",(0,r.jsx)(n.code,{children:"MAIN"})," sections are typically processed first and most thoroughly"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Page Flow"}),": Controls how content flows across multi-page documents"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"role-hints-semantic-roles",children:"Role Hints (Semantic Roles)"}),"\n",(0,r.jsxs)(n.p,{children:["Role hints are ",(0,r.jsx)(n.strong,{children:"free-form semantic labels"})," stored in ",(0,r.jsx)(n.code,{children:'section.tags["role_hint"]'})," that provide business-specific meaning:"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'"claim_information"'})," - Contains claim details (numbers, patient info)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'"service_lines"'})," - Medical service billing data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'"remarks"'})," - Remark codes and descriptions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:'"claim_totals"'})," - Financial summary information"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Purpose:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Downstream Processing"}),": Different processors handle sections based on role hints"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Field Mapping"}),": Determines which annotation selectors apply to which sections"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Business Logic"}),": Enables section-specific processing rules"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"role-normalization-process",children:"Role Normalization Process"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"normalize_role()"})," function handles the conversion from configuration strings to proper roles:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def normalize_role(value: str) -> Tuple[SectionRole, Optional[str]]:\n    # Known enum values \u2192 SectionRole enum\n    if value in ["main", "context_above", "context_below", "sidebar"]:\n        return SectionRole.MAIN, None  # (example)\n    \n    # Unknown strings \u2192 semantic role hint\n    else:\n        return SectionRole.UNKNOWN, "custom_business_role"\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"core-data-structures",children:"Core Data Structures"}),"\n",(0,r.jsx)(n.h3,{id:"1-keyvalue",children:"1. KeyValue"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Represents a single key-value pair extracted from document content."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'class KeyValue(BaseModel):\n    key: str                           # Field name (e.g., "CLAIM_NUMBER")\n    value: str                         # Extracted value (e.g., "Z7P4M2Q")\n    value_type: ValueType             # Data type classification\n    normalized: Optional[str]         # Cleaned/standardized value\n    source: Optional[TextSpan]        # Source location in document\n    tags: Dict[str, str]              # Additional metadata\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Single field extractions (claim numbers, dates, amounts)"}),"\n",(0,r.jsx)(n.li,{children:"Header information"}),"\n",(0,r.jsx)(n.li,{children:"Summary/totals data"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-kvlist",children:"2. KVList"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Container for multiple related key-value pairs forming a logical group."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'class KVList(BlockBase):\n    type: Literal["kvlist"] = "kvlist"\n    items: List[KeyValue]             # Collection of related KV pairs\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Claim information sections (patient name, claim number, provider)"}),"\n",(0,r.jsx)(n.li,{children:"Summary totals (deductibles, copays, allowed amounts)"}),"\n",(0,r.jsx)(n.li,{children:"Configuration parameters"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-rowrole",children:"3. RowRole"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Classifies the semantic function of table rows."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'class RowRole(str, Enum):\n    HEADER = "header"        # Column headers\n    SUBHEADER = "subheader"  # Secondary headers\n    BODY = "body"            # Data rows\n    SECTION = "section"      # Section dividers\n    FOOTER = "footer"        # Table footers\n    TOTALS = "totals"        # Summary/calculation rows\n    SPACER = "spacer"        # Visual separation\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Table parsing and validation"}),"\n",(0,r.jsx)(n.li,{children:"Data extraction prioritization"}),"\n",(0,r.jsx)(n.li,{children:"Display formatting"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"4-tablerow",children:"4. TableRow"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Represents a single row within a table structure with metadata."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class TableRow(BaseModel):\n    role: RowRole                     # Semantic function of the row\n    cells: List[CellWithMeta]         # Cell content with metadata\n    source_page: Optional[int]        # Originating page\n    source_line_ids: Optional[List[int]]  # Line numbers for traceability\n    tags: Dict[str, str]              # Additional metadata\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Service line data (dates, procedures, amounts)"}),"\n",(0,r.jsx)(n.li,{children:"Multi-page table reconstruction"}),"\n",(0,r.jsx)(n.li,{children:"Data validation and error tracking"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"5-tableseries",children:"5. TableSeries"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Manages multi-page tables as a cohesive unit."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'class TableSeries(BlockBase):\n    type: Literal["table_series"] = "table_series"\n    series_id: Optional[str]          # Unique identifier\n    segments: List[TableBlock]        # Page-specific table segments\n    unified_header: Optional[List[str]]   # Consistent column headers\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Methods:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"pages()"}),": Returns all pages containing table data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"iter_rows(roles)"}),": Iterates through rows filtered by role"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Service lines spanning multiple pages"}),"\n",(0,r.jsx)(n.li,{children:"Large datasets requiring pagination"}),"\n",(0,r.jsx)(n.li,{children:"Cross-page data correlation"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"6-section",children:"6. Section"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Groups related content blocks under a semantic heading."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class Section(BaseModel):\n    title: Optional[str]              # Section heading\n    role: SectionRole                 # Layout positioning\n    blocks: List[Block]               # Content (KVList, TableSeries, etc.)\n    span: Optional[PageSpan]          # Multi-page footprint\n    tags: Dict[str, str]              # Including role_hint\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Organizing document into logical parts"}),"\n",(0,r.jsx)(n.li,{children:"Applying section-specific processing rules"}),"\n",(0,r.jsx)(n.li,{children:"Maintaining document hierarchy"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"7-structuredregion",children:"7. StructuredRegion"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Top-level container representing a complete logical document unit."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"class StructuredRegion(BaseModel):\n    region_id: Optional[str]          # Business identifier\n    span: Optional[PageSpan]          # Complete page coverage\n    parts: List[RegionPart]           # Page-specific content\n    tags: Dict[str, str]              # Region-level metadata\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Methods:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sections_flat()"}),": All sections in page order"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"find_section(name)"}),": Locate section by title"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"table_series()"}),": Extract all table data"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Complete claim processing units"}),"\n",(0,r.jsx)(n.li,{children:"Document-level validation"}),"\n",(0,r.jsx)(n.li,{children:"Multi-page document assembly"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"8-valuetype",children:"8. ValueType"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Classifies the semantic type of extracted values for validation and processing."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'class ValueType(str, Enum):\n    STRING = "string"     # General text\n    NUMBER = "number"     # Numeric values\n    MONEY = "money"       # Currency amounts\n    DATE = "date"         # Date/time values\n    CODE = "code"         # Structured codes (procedure, diagnosis)\n    NAME = "name"         # Person/entity names\n    ID = "id"             # Identifiers\n    UNKNOWN = "unknown"   # Unclassified\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use Cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Data validation"}),"\n",(0,r.jsx)(n.li,{children:"Format standardization"}),"\n",(0,r.jsx)(n.li,{children:"Type-specific processing rules"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"builder-functions",children:"Builder Functions"}),"\n",(0,r.jsx)(n.h3,{id:"build_structured_region",children:"build_structured_region()"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Constructs a complete StructuredRegion from sections and page spans."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Features:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Validation"}),": Prevents untitled or duplicate sections"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Page Distribution"}),": Automatically distributes sections across pages based on spans"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Span Management"}),": Handles multi-page content coordination"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Usage Pattern:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'region = build_structured_region(\n    region_id="claim_12345",\n    region_span=aggregate_span,  # Covers all relevant pages\n    sections=[claim_info_section, service_lines_section, totals_section]\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"build_table_series_from_pagespan",children:"build_table_series_from_pagespan()"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Purpose"}),": Creates TableSeries from page-distributed table data."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Features:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Multi-page Coordination"}),": Links table segments across pages"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Header Management"}),": Maintains consistent column headers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Row Association"}),": Preserves row relationships across page breaks"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Usage Pattern:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'series = build_table_series_from_pagespan(\n    series_id="service_lines_claim_12345",\n    pagespan=table_span,\n    table=table_obj,\n    all_rows=table_rows,\n    header_binding=["Date", "Procedure", "Amount"]\n)\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"configuration-examples",children:"Configuration Examples"}),"\n",(0,r.jsx)(n.h3,{id:"layer-configuration-with-roles",children:"Layer Configuration with Roles"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"layers:\n  layer-main:\n    region_parser:\n      parsing_method: mrp\n      sections:\n        - title: CLAIM INFORMATION\n          role: claim_information    # \u2192 role_hint\n          parse: kv\n        - title: SERVICE LINES\n          role: main                # \u2192 SectionRole.MAIN\n          parse: table\n        - title: CLAIM TOTALS\n          role: context_below       # \u2192 SectionRole.CONTEXT_BELOW\n          parse: kv\n\n  layer-remarks:\n    region_parser:\n      parsing_method: section_processor\n    regions:\n      - title: REMARK CODES\n        role: remarks              # \u2192 role_hint\n"})}),"\n",(0,r.jsx)(n.h3,{id:"processing-flow",children:"Processing Flow"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Configuration Parse"}),": Role strings converted via ",(0,r.jsx)(n.code,{children:"normalize_role()"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Section Creation"}),": Sections created with proper SectionRole + role_hint tags"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Content Processing"}),": Different processors handle sections based on role_hints"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Field Mapping"}),": Annotation selectors applied based on semantic roles"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Output Generation"}),": Structured data ready for downstream consumers"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"role-assignment",children:"Role Assignment"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use standard SectionRole enums"})," when content fits layout patterns"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use descriptive role_hints"})," for business-specific processing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Be consistent"})," with role naming across similar document types"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"section-organization",children:"Section Organization"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"One primary MAIN section"})," per region (typically the largest table)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Context sections"})," for supporting information"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Clear, unique titles"})," for all sections"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"multi-page-handling",children:"Multi-page Handling"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use TableSeries"})," for tables spanning pages"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Maintain header consistency"})," across page breaks"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Preserve row ordering"})," and relationships"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"validation",children:"Validation"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Check for required sections"})," in business logic"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Validate data types"})," using ValueType"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Ensure span coverage"})," matches actual content"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This documentation provides the foundation for understanding how the structured region system organizes document content into processable, semantic structures that support both layout-based and business-specific processing requirements."}),"\n",(0,r.jsx)(n.h1,{id:"documentation-role-hints-in-the-extract-visitor-system",children:"Documentation: Role Hints in the Extract Visitor System"}),"\n",(0,r.jsx)(n.h2,{id:"how-role-hints-are-used-in-production",children:"How Role Hints Are Used in Production"}),"\n",(0,r.jsxs)(n.p,{children:["Based on the system architecture, here's how ",(0,r.jsx)(n.code,{children:"role_hint"})," values are utilized in the extraction visitor to enable dynamic, business-specific processing:"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"role-hint-processing-flow",children:"Role Hint Processing Flow"}),"\n",(0,r.jsxs)(n.h3,{id:"1-section-processing-discovery",children:["1. ",(0,r.jsx)(n.strong,{children:"Section Processing Discovery"})]}),"\n",(0,r.jsx)(n.p,{children:"When the extraction visitor processes structured regions, it examines each section's role hint to determine the appropriate processing method:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# In the match_section_extract_visitor.py\nrole_hint = structured_section.tags.get("role_hint")\nif not role_hint:\n    # Skip sections without role hints or use default processing\n    continue\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"2-processing-method-selection",children:["2. ",(0,r.jsx)(n.strong,{children:"Processing Method Selection"})]}),"\n",(0,r.jsx)(n.p,{children:"The system uses role hints to route sections to specialized processors:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Example processing logic\nfor rule in processing_rules:\n    if rule.get("role") == role_hint:\n        parse_method = rule.get("parse")  # "kv", "table", "custom"\n        \n        if parse_method == "table":\n            self._process_region_as_table(context, structured_section, rule)\n        elif parse_method == "kv":\n            self._process_region_as_kv(context, structured_section, rule)\n        elif parse_method == "custom":\n            self._process_custom_region(context, structured_section, rule)\n        \n        break\nelse:\n    self.logger.warning(\n        f"No processing rule found for role_hint \'{role_hint}\'"\n    )\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"3-field-mapping-based-on-role-hints",children:["3. ",(0,r.jsx)(n.strong,{children:"Field Mapping Based on Role Hints"})]}),"\n",(0,r.jsx)(n.p,{children:"The system maps different annotation selectors to fields based on the section's role hint:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Field mapping lookup by role hint\nscoped_field_mappings = [\n    fm for fm in field_mappings \n    if fm.scope == FieldScope.REGION and fm.role == role_hint\n]\n\nif not scoped_field_mappings:\n    self.logger.warning(\n        f\"No REGION-scoped field mappings with role '{role_hint}' \"\n        f\"found for section '{structured_section.title}'\"\n    )\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"practical-usage-examples",children:"Practical Usage Examples"}),"\n",(0,r.jsx)(n.h3,{id:"example-1-service-lines-processing",children:"Example 1: Service Lines Processing"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'layers:\n  layer-main:\n    region_parser:\n      sections:\n        - title: SERVICE LINES\n          role: service_lines    # Becomes role_hint\n          parse: table\n\n    regions:\n      - title: SERVICE LINES\n        role: service_lines\n        type: table\n        table:\n          columns:\n            DATE_OF_SERVICE:\n              annotation_selectors: ["DATES_OF_SERVICE"]\n            PROCEDURE_CODE:\n              annotation_selectors: ["PROCEDURE_DESCRIPTION"]\n            BILLED_AMOUNT:\n              annotation_selectors: ["BILLED_AMOUNT"]\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Processing Result:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Section created with ",(0,r.jsx)(n.code,{children:'role_hint = "service_lines"'})]}),"\n",(0,r.jsxs)(n.li,{children:["Extract visitor finds rule for ",(0,r.jsx)(n.code,{children:'role = "service_lines"'})]}),"\n",(0,r.jsx)(n.li,{children:"Processes section as table with specific column mappings"}),"\n",(0,r.jsxs)(n.li,{children:["Applies annotation selectors: ",(0,r.jsx)(n.code,{children:"DATES_OF_SERVICE"}),", ",(0,r.jsx)(n.code,{children:"PROCEDURE_DESCRIPTION"}),", ",(0,r.jsx)(n.code,{children:"BILLED_AMOUNT"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example-2-remarks-processing",children:"Example 2: Remarks Processing"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"layers:\n  layer-remarks:\n    region_parser:\n      parsing_method: section_processor\n    regions:\n      - title: REMARK CODES\n        role: remarks    # Becomes role_hint\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Processing Result:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Section created with ",(0,r.jsx)(n.code,{children:'role_hint = "remarks"'})]}),"\n",(0,r.jsxs)(n.li,{children:["Region processor (",(0,r.jsx)(n.code,{children:"remarks_processor"}),") handles sections with ",(0,r.jsx)(n.code,{children:'role = "remarks"'})]}),"\n",(0,r.jsx)(n.li,{children:"Custom logic parses remark codes and descriptions"}),"\n",(0,r.jsx)(n.li,{children:"Outputs structured TableSeries with remark data"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"example-3-claim-information-processing",children:"Example 3: Claim Information Processing"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'layers:\n  layer-main:\n    region_parser:\n      sections:\n        - title: CLAIM INFORMATION\n          role: claim_information    # Becomes role_hint\n          parse: kv\n\n    regions:\n      - title: CLAIM INFORMATION\n        role: claim_information\n        type: kv\n        fields:\n          CLAIM_NUMBER:\n            annotation_selectors: ["CLAIM NUMBER"]\n          PATIENT_NAME:\n            annotation_selectors: ["PATIENT NAME"]\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Processing Result:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Section created with ",(0,r.jsx)(n.code,{children:'role_hint = "claim_information"'})]}),"\n",(0,r.jsx)(n.li,{children:"Extract visitor processes as key-value pairs"}),"\n",(0,r.jsx)(n.li,{children:"Maps specific fields using annotation selectors"}),"\n",(0,r.jsx)(n.li,{children:"Creates KVList with claim information"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"advanced-role-hint-usage",children:"Advanced Role Hint Usage"}),"\n",(0,r.jsxs)(n.h3,{id:"1-conditional-processing-rules",children:["1. ",(0,r.jsx)(n.strong,{children:"Conditional Processing Rules"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def process_section_by_role_hint(self, section, role_hint):\n    """Process sections based on their role hint."""\n    \n    if role_hint == "service_lines":\n        # Complex table processing with grouping\n        self._process_service_lines_table(section)\n        \n    elif role_hint == "claim_totals":\n        # Financial validation and calculation\n        self._process_financial_totals(section)\n        \n    elif role_hint == "remarks":\n        # Code normalization and lookup\n        self._process_remark_codes(section)\n        \n    elif role_hint.startswith("custom_"):\n        # Business-specific custom processing\n        self._process_custom_business_logic(section, role_hint)\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"2-role-hint-inheritance",children:["2. ",(0,r.jsx)(n.strong,{children:"Role Hint Inheritance"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def inherit_processing_rules(self, parent_role_hint, section):\n    """Inherit processing behavior from parent sections."""\n    \n    if parent_role_hint == "claim_information":\n        # All child sections inherit claim processing rules\n        section.tags["inherited_role"] = parent_role_hint\n        section.tags["processing_mode"] = "claim_focused"\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"3-multi-role-processing",children:["3. ",(0,r.jsx)(n.strong,{children:"Multi-Role Processing"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def process_composite_roles(self, section):\n    """Handle sections that serve multiple purposes."""\n    \n    role_hint = section.tags.get("role_hint")\n    secondary_roles = section.tags.get("secondary_roles", [])\n    \n    # Primary processing\n    self.process_by_role(section, role_hint)\n    \n    # Additional processing for secondary roles\n    for secondary_role in secondary_roles:\n        self.apply_secondary_processing(section, secondary_role)\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"configuration-patterns",children:"Configuration Patterns"}),"\n",(0,r.jsx)(n.h3,{id:"pattern-1-role-specific-field-scoping",children:"Pattern 1: Role-Specific Field Scoping"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# Different fields extracted based on role hint\nnon_repeating_fields:\n  CLAIM_NUMBER:\n    scope: REGION\n    role: claim_information    # Only applies to sections with this role_hint\n    annotation_selectors: ["CLAIM NUMBER"]\n    \n  REMARK_CODE:\n    scope: REGION  \n    role: remarks             # Only applies to remark sections\n    annotation_selectors: ["REMARKS_CODE"]\n'})}),"\n",(0,r.jsx)(n.h3,{id:"pattern-2-processing-method-override",children:"Pattern 2: Processing Method Override"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"processing_rules:\n  - role: service_lines\n    parse: table\n    validation: strict        # Custom processing options\n    \n  - role: remarks  \n    parse: custom\n    processor: remarks_processor\n    \n  - role: claim_totals\n    parse: kv\n    post_process: financial_validation\n"})}),"\n",(0,r.jsx)(n.h3,{id:"pattern-3-cross-section-dependencies",children:"Pattern 3: Cross-Section Dependencies"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"dependencies:\n  - source_role: claim_information\n    target_role: service_lines\n    relationship: validates_against\n    \n  - source_role: service_lines\n    target_role: claim_totals\n    relationship: sums_to\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"best-practices-for-role-hint-usage",children:"Best Practices for Role Hint Usage"}),"\n",(0,r.jsxs)(n.h3,{id:"1-consistent-naming",children:["1. ",(0,r.jsx)(n.strong,{children:"Consistent Naming"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use descriptive, business-meaningful names"}),"\n",(0,r.jsxs)(n.li,{children:["Follow snake_case convention: ",(0,r.jsx)(n.code,{children:"claim_information"}),", ",(0,r.jsx)(n.code,{children:"service_lines"}),", ",(0,r.jsx)(n.code,{children:"claim_totals"})]}),"\n",(0,r.jsxs)(n.li,{children:["Avoid generic names like ",(0,r.jsx)(n.code,{children:"section1"}),", ",(0,r.jsx)(n.code,{children:"data"}),", ",(0,r.jsx)(n.code,{children:"content"})]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"2-hierarchical-organization",children:["2. ",(0,r.jsx)(n.strong,{children:"Hierarchical Organization"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use prefixes for related sections: ",(0,r.jsx)(n.code,{children:"claim_info"}),", ",(0,r.jsx)(n.code,{children:"claim_totals"}),", ",(0,r.jsx)(n.code,{children:"claim_notes"})]}),"\n",(0,r.jsxs)(n.li,{children:["Group similar processing types: ",(0,r.jsx)(n.code,{children:"table_service_lines"}),", ",(0,r.jsx)(n.code,{children:"table_procedures"})]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"3-role-hint-documentation",children:["3. ",(0,r.jsx)(n.strong,{children:"Role Hint Documentation"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Document expected role hints in your processor\nEXPECTED_ROLE_HINTS = {\n    "service_lines": "Primary billing data table with dates, procedures, amounts",\n    "claim_information": "Key-value pairs with claim identifiers and patient info", \n    "claim_totals": "Financial summary with totals, deductibles, payments",\n    "remarks": "Remark codes and descriptions for billing clarifications"\n}\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"4-validation-and-error-handling",children:["4. ",(0,r.jsx)(n.strong,{children:"Validation and Error Handling"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def validate_role_hint_support(self, role_hint):\n    """Ensure role hint is supported by current configuration."""\n    \n    if role_hint not in self.supported_role_hints:\n        raise ValueError(\n            f"Unsupported role_hint \'{role_hint}\'. "\n            f"Supported hints: {list(self.supported_role_hints.keys())}"\n        )\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,r.jsx)(n.p,{children:"Role hints provide the critical bridge between static configuration and dynamic processing logic. They enable:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Selective Processing"}),": Only relevant sections get processed by appropriate handlers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Field Scoping"}),": Different annotation selectors apply to different section types"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Business Logic"}),": Custom processing rules based on document semantics"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Extensibility"}),": Easy addition of new section types without code changes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Maintainability"}),": Clear separation between layout roles and business logic"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The role hint system transforms the structured region framework from a generic document parser into a flexible, business-aware extraction engine that can adapt to different document types and processing requirements through configuration alone."})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);